+function(e,t,n){"use strict";var i={init:function(t){t=this.setOptions(t||{}),e.init(),AjaxCommon.cookieItem.getCookie("dddjsid",function(e){t.sid=e;var n={urlPath:t.getGoodsMenuListUrl,data:{sid:t.sid},onBeforeSend:function(){},onSuccess:function(e){0==e.status?t.this.initGetTagsUrl(t,e):common.alert({msg:e.message||"读取出错"})},onError:function(){console.log("失败回调")}};AjaxCommon.getAjaxRequestJson(n)})},setOptions:function(e){return e.this=this,e.scale=.56,e.getGoodsMenuListUrl=common.config.appPath+"/api/goods/listGroups",e.getGoodsListUrl=common.config.appPath+"/api/goods/list",e.bodyContainer=t.getElementById("pull-body"),e.tmplHtmlModelEmpty=t.getElementById("tmpl-model-null"),e.searchInput=t.getElementById("search-input"),e.searchInputBtn=t.querySelector(".icon-search"),e},initGetTagsUrl:function(n,i){var o=template("tmpl-menus",i);n.bodyContainer.innerHTML=o;for(var r=n.bodyContainer.querySelectorAll(".list-container"),l=0;l<r.length;l++){r[l].style.minHeight=window.screen.height-84-52-40+"px"}var a=e.os.ios?.003:9e-4;e(".mui-scroll-wrapper").scroll({bounce:!1,indicators:!1,deceleration:a}),e(".mui-slider").slider(),n.controls=document.getElementById("segmentedControls"),n.contents=document.getElementById("segmentedControlContents"),n.this.initLeftListEvents(n),n.this.DomTabSelected(n),e.each(n.this.getScrollContainers(),function(t,i){e(i).pullToRefresh({up:{contentnomore:"底线在此,不要再拉啦~",callback:function(){var e=this;n.this.pullUpLoadGoodsGroup(n,e)}}})}),e.os.plus?e.plusReady(function(){setTimeout(function(){n.this.pullUpLoading(n)},1e3)}):e.ready(function(){n.this.pullUpLoading(n)}),AjaxCommon.pageInit(".list-container"),null!=n.searchInputBtn&&n.searchInputBtn.addEventListener("tap",function(){var e=n.searchInput.value.trim();""!=e&&setTimeout(function(){window.location.href=common.config.rootPath+"/goods/search.html?sv="+e},100)})},initLeftListEvents:function(t){document.querySelector(".mui-slider").addEventListener("slide",function(e){setTimeout(function(){t.this.pullUpLoading(t)},500)}),e(".dddj-menu").on("tap",".menu-backtop",function(){t.this.pullUpToRefreshScrollToTop(t)})},pullUpLoading:function(t){var n=t.this.getActiveProductContainer(),i=t.this.getScrollContainers(),o=n.querySelector(".list-container");if(""===o.innerHTML.trim()){e(i[o.dataset.index]).pullToRefresh().pullUpLoading()}},pullUpToRefresh:function(t){var n=t.this.getActiveProductContainer(),i=t.this.getScrollContainers(),o=n.querySelector(".list-container");if(o.setAttribute("data-pageindex",0),n.querySelector(".list-container").innerHTML="",""===o.innerHTML.trim()){var s=o.dataset.index;e(i[s]).pullToRefresh().refresh(!0),e(i[s]).pullToRefresh().pullUpLoading()}},getActiveProductContainer:function(){return t.querySelector(".mui-control-content.mui-active")},getScrollContainers:function(){return e(document.querySelectorAll(".mui-slider-group .mui-scroll"))},pullUpLoadGoodsGroup:function(e,t){var n=e.this.getActiveProductContainer();if(null==n)return common.alert({msg:"获取当前模块出错"}),!1;var i=n.querySelector(".list-container"),o=i.getAttribute("data-pageIndex");o=parseInt(o)+1,i.setAttribute("data-pageIndex",o);var s=e.this.getDefaultSelected(n),r={sid:e.sid,gid:i.dataset.id,sorts:s,pageIndex:o,distrbution:""},l={urlPath:e.getGoodsListUrl,data:r,onSuccess:function(s){if(0==s.status){if(s.data.content.length>0){var r=template("tmpl-goods",s.data);i.innerHTML+=r,e.this.inspectTrim(i),1==o&&e.controls.querySelectorAll(".mui-control-item")[i.dataset.index].querySelector("span").innerText.indexOf("(")<0&&(e.controls.querySelectorAll(".mui-control-item")[i.dataset.index].querySelector("span").innerText+="("+s.data.totalElements+")"),e.this.initEvent(e)}else""==i.innerHTML.trim()&&(i.innerHTML=e.tmplHtmlModelEmpty.innerHTML);s.data.hasNextPage?t.endPullUpToRefresh(!1):t.endPullUpToRefresh(!0),null==n.querySelector(".spinner-child")||n.querySelector(".spinner-child").classList.contains("mui-hide")||n.querySelector(".spinner-child").classList.add("mui-hide")}else common.alert({msg:s.msg||"读取出错"})},onError:function(){console.log("失败回调"),null==n.querySelector(".spinner-child")||n.querySelector(".spinner-child").classList.contains("mui-hide")||n.querySelector(".spinner-child").classList.add("mui-hide"),""==i.innerHTML.trim()&&(i.innerHTML=e.tmplHtmlModelEmpty.innerHTML)}};AjaxCommon.getAjaxRequestJson(l)},pullUpToRefreshScrollToTop:function(t){e(t.this.getActiveProductContainer().querySelector(".mui-scroll-wrapper")).pullRefresh().scrollTo(0,0,1500)},inspectTrim:function(t){var n=t.querySelectorAll(".mui-control a");e(n).each(function(e,t){""!=n[e].innerHTML.trim()||n[e].parentElement.classList.contains("mui-hide")||n[e].parentElement.classList.add("mui-hide")})},initEvent:function(e){},DomTabSelected:function(e){for(var n=t.querySelectorAll(".menuType"),i=0;i<n.length;i++)for(var o=n[i],s=o.querySelectorAll("li"),r=0;r<s.length;r++){var l=s[r];l.addEventListener("tap",function(){var t=this,n=t.dataset.name;switch(console.log(n),n){case"sold":var i=o.querySelector('li[data-name="price"]');i.classList.remove("mui-active-top"),i.classList.remove("mui-active-bottom"),1==t.classList.contains("mui-active")?t.classList.remove("mui-active"):t.classList.add("mui-active");break;case"price":var i=o.querySelector('.menuType li[data-name="sold"]');i.classList.remove("mui-active"),t.classList.contains("mui-active-top")?(t.classList.remove("mui-active-top"),t.classList.add("mui-active-bottom")):t.classList.contains("mui-active-bottom")?(t.classList.remove("mui-active-top"),t.classList.remove("mui-active-bottom")):(t.classList.add("mui-active-top"),t.classList.remove("mui-active-bottom"))}e.this.pullUpToRefresh(e)})}},getDefaultSelected:function(){for(var e=t.querySelector(".menuType"),n="",i=e.querySelectorAll("li"),o=0;o<i.length;o++)i[o].classList.contains("mui-active")?n="sold desc":i[o].classList.contains("mui-active-top")?n="price desc":i[o].classList.contains("mui-active-bottom")&&(n="price asc");return console.log(n),n}};window.goodsIndex=i}(mui,document);